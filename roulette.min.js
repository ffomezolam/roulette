!function(t,i,a){"undefined"!=typeof module&&module.exports?module.exports=a():"function"==typeof define&&define.amd?define(a):i.Roulette=a()}(0,this,function(){function t(t,i){return t=t.toLowerCase(),Object.prototype.toString.call(i).toLowerCase().slice(8,-1)==t}function i(t,i){return t===i}function a(t,i,a){return{item:t,tally:i,probability:a,pcum:0}}function e(t){this.length=0,this.autocalibrate=!(t&&"autocalibrate"in t)||!!t.autocalibrate,this._data=[],this._total=0,this._compare=i,this._aliases={},this._weight=1}return e.select=function(t,i){},e.prototype.add=function(i){if(arguments.length>1){var e=this.autocalibrate;e&&(this.autocalibrate=!1);for(var r=0,s=arguments.length;r<s;r++)this.add(arguments[r]);e&&(this.autocalibrate=!0,this.calibrate())}else{var h=this.indexOf(i);h<0?(this._data.push(a(i,1,0)),this.length=this._data.length,this._total++,(t("string",i)||t("number",i))&&(this._aliases[i]=this.length-1)):(this._data[h].tally++,this._total++),this.autocalibrate&&this.calibrate()}return this},e.prototype.remove=function(i){if(arguments.length>1){var a=this.autocalibrate;a&&(this.autocalibrate=!1);for(var e=0,r=arguments.length;e<r;e++)this.remove(arguments[e]);a&&(this.autocalibrate=!0,this.calibrate())}else{var s=this.indexOf(i);if(s<0)return this;this._data[s].tally>0&&(this._data[s].tally--,this._total--),this._data[s].tally||(this._data.splice(s,1),this.length=this._data.length,(t("string",i)||t("number",i))&&(delete this._aliases[i],this._realias(s))),this.autocalibrate&&this.calibrate()}return this},e.prototype.purge=function(i){var a=this.indexOf(i);if(a<0)return this;var e=this._data[a].tally;return this._total-=e,this._data.splice(a,1),this.length=this._data.length,(t("string",i)||t("number",i))&&(delete this._aliases[i],this._realias(a)),this.autocalibrate&&this.calibrate(),this},e.prototype._realias=function(i){if((!t("number",i)||i<0)&&(i=0),i>this.length-1)return this;for(var a=i,e=this.length;a<e;a++){var r=this._data[a].item;this._aliases[r]=a}return this},e.prototype.indexOf=function(i){if(!this.length)return-1;if(t("string",i)||t("number",i))return i in this._aliases?this._aliases[i]:-1;for(var a=0,e=this.length;a<e;a++){var r=this._data[a].item;if(null!=r&&this._compare(i,r))return a}return-1},e.prototype.has=function(t){return!!(this.indexOf(t)>=0)},e.prototype.get=function(t){"Number"==typeof t&&t!=this._weight&&this.calibrate(t);var i=Math.random();if(i>=1)return this._data[this.length-1].item;if(i<=0)return this._data[0].item;for(var a=0,e=this.length;a<e;a++){var r=this._data[a].pcum;if(console.log("prob of "+this._data[a].item+": ",r),r>i)return this._data[a].item}return null},e.prototype.index=function(i){return this.length&&t("number",i)&&i>=0&&i<this.length?this._data[i].item:null},e.prototype.calibrate=function(t){if(!this._total)return this;void 0===t&&(t=1),t<0?t=0:t>100&&(t=100),this._weight=t;for(var i=[],a=0,e=this.length;a<e;a++){var r=this._data[a].tally/this._total;i[a]=r}for(var a=0,e=this.length;a<e;a++)this._data[a].probability=r,this._data[a].pcum=a?this._data[a-1].pcum+r:r;return this},e.prototype.setCompare=function(t){return this._compare=t,this},e});